<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- 上述3个meta标签*必须*放在最前面，任何其他内容都*必须*跟随其后！ -->
    <title>Bootstrap 101 Template</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css" rel="stylesheet">

  </head>
  <body>

  	<div class="container">
  		<div class="page-header">
		  <h1> CRC30NS<small> Hello CyberMiles</small></h1>
		</div>
		<div class="panel panel-default">
		  <div class="panel-heading">
		  	<h3 class="panel-title">Look Up</h3>
		  </div>
		  <div class="panel-body">
		    <form>
			  <div class="form-group">
			    <label for="symbolInput">Symbol</label>
			    <input type="text" class="form-control" id="symbolInput" placeholder="symbol">
			  </div>
			 <div class="form-group" id="lookupResult">
			 </div>
			  <button type="button" id="lookup_btn" class="btn btn-primary">Submit</button>
			</form>
		  </div>
		</div>
  		
  	</div>
    

    <!-- jQuery (Bootstrap 的所有 JavaScript 插件都依赖 jQuery，所以必须放在前边) -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
    <!-- 加载 Bootstrap 的所有 JavaScript 插件。你也可以根据需要只加载单个插件。 -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js"></script>
    <script type="text/javascript">
    	$().ready(function(){


    		App = {
    			crcContract:{
    				api : [
                    {
                        "constant": false,
                        "inputs": [
                            {
                                "name": "_symbol",
                                "type": "string"
                            }
                        ],
                        "name": "forceRemove",
                        "outputs": [
                            {
                                "name": "",
                                "type": "bool"
                            }
                        ],
                        "payable": false,
                        "stateMutability": "nonpayable",
                        "type": "function"
                    },
                    {
                        "constant": false,
                        "inputs": [
                            {
                                "name": "_contractAddr",
                                "type": "address"
                            },
                            {
                                "name": "_desc",
                                "type": "string"
                            },
                            {
                                "name": "_exitPrice",
                                "type": "uint256"
                            }
                        ],
                        "name": "register",
                        "outputs": [
                            {
                                "name": "",
                                "type": "bool"
                            }
                        ],
                        "payable": true,
                        "stateMutability": "payable",
                        "type": "function"
                    },
                    {
                        "constant": false,
                        "inputs": [],
                        "name": "terminate",
                        "outputs": [],
                        "payable": false,
                        "stateMutability": "nonpayable",
                        "type": "function"
                    },
                    {
                        "inputs": [],
                        "payable": false,
                        "stateMutability": "nonpayable",
                        "type": "constructor"
                    },
                    {
                        "constant": false,
                        "inputs": [
                            {
                                "name": "_symbol_length",
                                "type": "uint256"
                            },
                            {
                                "name": "fee",
                                "type": "uint256"
                            }
                        ],
                        "name": "updateFee",
                        "outputs": [
                            {
                                "name": "",
                                "type": "bool"
                            }
                        ],
                        "payable": false,
                        "stateMutability": "nonpayable",
                        "type": "function"
                    },
                    {
                        "constant": false,
                        "inputs": [
                            {
                                "name": "_contractAddr",
                                "type": "address"
                            },
                            {
                                "name": "_desc",
                                "type": "string"
                            },
                            {
                                "name": "_exitPrice",
                                "type": "uint256"
                            }
                        ],
                        "name": "updateRegistration",
                        "outputs": [
                            {
                                "name": "",
                                "type": "bool"
                            }
                        ],
                        "payable": false,
                        "stateMutability": "nonpayable",
                        "type": "function"
                    },
                    {
                        "constant": false,
                        "inputs": [
                            {
                                "name": "_amount",
                                "type": "uint256"
                            }
                        ],
                        "name": "withdraw",
                        "outputs": [
                            {
                                "name": "",
                                "type": "bool"
                            }
                        ],
                        "payable": false,
                        "stateMutability": "nonpayable",
                        "type": "function"
                    },
                    {
                        "constant": true,
                        "inputs": [
                            {
                                "name": "_symbol_length",
                                "type": "uint256"
                            }
                        ],
                        "name": "findFee",
                        "outputs": [
                            {
                                "name": "",
                                "type": "uint256"
                            }
                        ],
                        "payable": false,
                        "stateMutability": "view",
                        "type": "function"
                    },
                    {
                        "constant": true,
                        "inputs": [],
                        "name": "getBalance",
                        "outputs": [
                            {
                                "name": "",
                                "type": "uint256"
                            }
                        ],
                        "payable": false,
                        "stateMutability": "view",
                        "type": "function"
                    },
                    {
                        "constant": true,
                        "inputs": [
                            {
                                "name": "_symbol",
                                "type": "string"
                            },
                            {
                                "name": "_contractAddr",
                                "type": "address"
                            }
                        ],
                        "name": "isRegistered",
                        "outputs": [
                            {
                                "name": "",
                                "type": "bool"
                            }
                        ],
                        "payable": false,
                        "stateMutability": "view",
                        "type": "function"
                    },
                    {
                        "constant": true,
                        "inputs": [
                            {
                                "name": "_symbol",
                                "type": "string"
                            }
                        ],
                        "name": "lookup",
                        "outputs": [
                            {
                                "name": "",
                                "type": "address"
                            },
                            {
                                "name": "",
                                "type": "string"
                            },
                            {
                                "name": "",
                                "type": "uint256"
                            }
                        ],
                        "payable": false,
                        "stateMutability": "view",
                        "type": "function"
                    },
                    {
                        "constant": true,
                        "inputs": [],
                        "name": "owner",
                        "outputs": [
                            {
                                "name": "",
                                "type": "address"
                            }
                        ],
                        "payable": false,
                        "stateMutability": "view",
                        "type": "function"
                    }
                ],
                address : "0x244008a32ce67dbd5e8d953b95bcbffe16f47020",
                instance : null,
    			}
    		}


            //初始化合约
            var cContract = web3.cmt.contract(App.crcContract.api);
            App.crcContract.instance = cContract.at(App.crcContract.address);

            $("#lookup_btn").click(function () {
                var tokenSymbol = $("#symbolInput").val();

                App.crcContract.instance.lookup(tokenSymbol, function (err, result) {
                    if (!err){
                        var html = '<div class="alert alert-info" role="alert"> Address: ' + result[0] +' , Desc: ' + result[1] + " , ExitPrice: " + result[2]/Math.pow(10,18) + ' CMT </div>';
                        $("#lookupResult").html(html);
                    }
                })
            });

    	});

    </script>
  </body>
</html>